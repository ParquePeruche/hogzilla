package org.hogzilla.event


import java.util.HashMap
import java.util.Map

   
 class HogEvent(flow:Map[String,String]) 
  {
    var sensorid:Int=0;
    var eventsecond:Int=0;
    var signatureid:Int=0;
    var generatorid:Int=0;
    var priorityid:Int=0;
    var description:String="";
    
    def alert()
    {
     println(flow.get("flow:host_server_name"))    
     /*
      * iph
      * sig info
      * udph
      * refs url -> hog/xxx/xxx
      * payload -> txt
      *
    
 select * from event limit 2;
+-----+----------+-----------+-------------------+-------------+---------+-------------+------+------------------+---------------------+----------+
| sid | cid      | signature | classification_id | users_count | user_id | notes_count | type | number_of_events | timestamp           | id       |
+-----+----------+-----------+-------------------+-------------+---------+-------------+------+------------------+---------------------+----------+
|   1 | 16054689 |       135 |              NULL |           0 |    NULL |           0 |    1 |                0 | 2015-09-17 08:57:29 | 16054689 |
|   1 | 16054690 |       135 |              NULL |           0 |    NULL |           0 |    1 |                0 | 2015-09-17 08:57:29 | 16054690 |
+-----+----------+-----------+-------------------+-------------+---------+-------------+------+------------------+---------------------+----------+

 select * from data limit 1;
+-----+-----+----------------------------------------------------------------------------------------------------------+
| sid | cid | data_payload                                                                                             |
+-----+-----+----------------------------------------------------------------------------------------------------------+
|   1 |   3 | 6A3934D41694F0F674D7FEC611C8BB9C2DFF9A6D9AAF7D9CDBA32673E4B757F88BEB0E4948AFF88D2A2CC70B80D6B296E2FDE8B3 |
+-----+-----+----------------------------------------------------------------------------------------------------------+
  select * from udphdr limit 1;
+-----+-----+-----------+-----------+---------+----------+
| sid | cid | udp_sport | udp_dport | udp_len | udp_csum |
+-----+-----+-----------+-----------+---------+----------+
|   1 |   4 |     57787 |        53 |      48 |    46126 |
+-----+-----+-----------+-----------+---------+----------+

select * from reference limit 10;
+--------+---------------+---------+
| ref_id | ref_system_id | ref_tag |
+--------+---------------+---------+
|      1 |             1 | 219     |
|      2 |             1 | 480     |
|   6214 |             8 | www.virustotal.com/file/4DA4DB7C7547859B48FCEE2D4E0827983161F3FA04FA87BBFDBA558F9F80F74F/analysis/                                                                                                      |
    
 select * from iphdr limit 1;
+-----+-----+------------+-----------+--------+---------+--------+--------+-------+----------+--------+--------+----------+---------+
| sid | cid | ip_src     | ip_dst    | ip_ver | ip_hlen | ip_tos | ip_len | ip_id | ip_flags | ip_off | ip_ttl | ip_proto | ip_csum |
+-----+-----+------------+-----------+--------+---------+--------+--------+-------+----------+--------+--------+----------+---------+
|   1 |   1 | 1249343050 | 167838309 |      4 |       5 |      0 |     40 | 14308 |        0 |      0 |    246 |        6 |   32708 |
+-----+-----+------------+-----------+--------+---------+--------+--------+-------+----------+--------+--------+----------+---------+
1 row in set (0.01 sec)

[8.97974739250669   E-8 ,0.0,-9.161339947226096E-9 ,-1.725042389384666E-9  ,-1.1660366428679493E-5,-2.229284513010911E-6 ,-0.002875644572949017  ,-0.005013801929719776,1.823236922235471E-7,-1.3128700961041514E-4]
[1.2812717236727291 E-5 ,0.0,1.2675627898552595E-6 ,4.452141478628816E-7   ,-0.006167504344889899 ,-4.6835598586131906E-4,-0.0029335899933831118 ,2.512976513079738,-1.962487009383782E-4,-0.001103659917449222]
[-1.234417779858775 E-5 ,0.0,6.846817775242353 E-7 ,8.604358097621837E-8   ,0.0024077814825695606 ,1.61881887389243E-4   ,0.2856760327445778     ,-0.005013801929718057,3.0529630850474663E-7,-0.0011036599174492226]
[2.880208599895408  E-5 ,0.0,-9.739875129754096E-8 ,-2.1957736563679425E-8 ,0.002407781482569555  ,0.0101534843839657    ,-0.0029335899933831113 ,-0.00501380192971805,0.0014016942052507849,0.8699496158717259]
[-6.0026104177287904E-6 ,0.0,3.324172311233422 E-9 ,-4.4666319994555304E-9 ,0.002407781482569555  ,-4.6835598586131814E-4,0.7159475215883521     ,-0.00501380192971805,-1.3512520179453046E-4,-0.0011036599174492233]
    
    
      */
  
    }
  }

